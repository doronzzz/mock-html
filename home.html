<!DOCTYPE html>
<html>
	<head>
		<link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.6/css/bootstrap.min.css"/>

		<link rel="stylesheet" href="style.css"/>

		<script src="https://code.jquery.com/jquery-2.2.3.min.js"></script>
		<script src="https://cdnjs.cloudflare.com/ajax/libs/handlebars.js/4.0.5/handlebars.js">
		</script>

		<script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.6/js/bootstrap.min.js"></script>

		<link href='https://fonts.googleapis.com/css?family=Roboto:400,100,100italic,300,300italic,400italic,500,500italic,700italic,700,900italic,900' rel='stylesheet' type='text/css'>

		<link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/font-awesome/4.6.1/css/font-awesome.min.css">
	</head>

	<body>


		<script type="text/x-handlerbars-template" id="user-fields-modal">
			

			<div class="req-email-dialog">
				<div class="close-dialog pull-right">
					<i class="fa fa-close"></i>
				</div>

				<h5 class="helper-text text-muted">
					Not yet a customer ?
				</h5>
				<h4>
					Keep in touch
				</h4>

				{{#each fields.text}}
					<div class="fields">
						<input class="form-control" data-type="{{type}}" type="text" name="{{name}}" placeholder="{{fieldName}}"/>
					</div>
				{{/each}}

				{{#each fields.email}}
					<div class="fields">
						<label>{{fieldName}}</label>
						<input class="form-control" type="email" data-type="{{type}}" name="{{name}}"/>
					</div>
				{{/each}}

				{{#each fields.password}}
					<div class="fields">
						<label>{{fieldName}}</label>
						<input class="form-control" type="password" data-type="{{type}}" name="{{name}}"/>
					</div>
				{{/each}}

				{{#each fields.checkbox}}
					<div class="fields form-control">
						<input class="" type="checkbox" data-type="{{type}}" name="{{name}}"/>
						<label>{{fieldName}}</label>
					</div>
				{{/each}}


				<div class="btn btn-primary btn-lg btn-block" id="submit-fields">
					SEND
				</div>
			</div>

		</script>

		<script type="text/x-handlebars-template" id="offers_template">
		<div id="carousel-example-generic" class="carousel home-car slide" data-ride="carousel">
		  <!-- Indicators -->
		  <ol class="carousel-indicators">
		  	{{#each offers}}
			    	<li data-target="#carousel-example-generic" data-slide-to="{{@index}}">
			    	</li>
		    {{/each}}
		  </ol>

		  <!-- Wrapper for slides -->
		  <div class="carousel-inner" role="listbox">
				  {{#each offers}}
				  	<div class="item">
				  	<a href="/demo4/offer.html?maCode={{maCode}}&isStarted={{isStarted}}">
				  		<img src="http://192.168.8.207{{imageId}}"/>
				  	</a>

						<!-- <div class="row">
							<div class="col-md-6">
								<img src="resources/devices-icon.png"/>
							</div>
							<div class="col-md-6">
								<div>
									<h3>Great Devices.</h3>
									<h3>Affordable Prices.</h3>
								</div>
								<p class="text-muted">
									{{text}}
								</p>
								<a class="btn btn-success rounded-btn" href="product.html">
									SHOP NOW
								</a>
							</div>
						</div> -->
				    </div>
				  {{/each}}
		  </div>

		</div>

		</script>


		<div class="modal-overlay"></div>


		<div class="top-bar container">
			<div class="pull-right">

				<div class="">
					
						<span class="contact-us">
							<i class="glyphicon glyphicon-envelope"></i>
							Contact Us
						</span>
					
					
						<span class="cart">
							<i class="glyphicon glyphicon-shopping-cart"></i>
							Cart 
						</span>
					
						<span class="login" id="login-wrapper">

							<span class="logged-in">
								<i class="glyphicon glyphicon-user"></i>
								 Sign Out
							</span>

							<span class="btn btn-primary btn-sm sign-in">
								Sign In
							</span>



							<div class="login-dialog">
								<div class="close-dialog  pull-right">
									<i class="fa fa-close"></i>
								</div>

								<div class="">
									<input class="form-control" type="text" placeholder="Enter ID or Mobile #"/>
								</div>

								<div class="">
									<input class="form-control" type="password" placeholder="Password"/>
								</div>

								<div class="">
										<input class=""  type="checkbox" id="remember-me"/>
										<label for="remember-me" class="text-muted">
											Remember me on this computer
										</label>
								</div>

								<div class="btn btn-primary btn-lg btn-block">
									Sign in
								</div>

								<label class="helper-text text-muted">
									Don't have an account yet?
									<a> Sign up now!</a>
								</label>

							</div>

						</span>
					
				</div>

			</div>
		</div>
		<nav class="navbar navbar-default navbar-top">
		  <div class="container">
		    <div class="navbar-header">
		      <a class="navbar-brand" href="#">
		        <img alt="Brand" src="resources/logo.png" style="height:30px;">
		      </a>
		    </div>

		    <ul class="nav navbar-nav">
		    	<li class="active"><a href="#">Shop</a></li>
		    	<li><a href="#">Support</a></li>
		    	<li class="myNewComMenuItem">
		    		<a href="#">
			    		My NewCom
		    		<span class="icons">
			    			<i class="glyphicon glyphicon-menu-up"></i>
		    				<i class="glyphicon glyphicon-menu-down"></i>
		    		</span>
		    		</a>
		    	</li>
		    </ul>



		    <div id="myNewComMenu">
		    	<div class="row">
		    		<div class="col-md-3">
		    			<div class="header">Your plan & bills</div>
		    			<div class="links">
		    				<div>Recent Bills</div>
		    				<div>What you've used</div>
		    				<div>Contract Details</div>
		    			</div>
		    		</div>
		    		<div class="col-md-3">
		    			<div class="header">Ways to pay</div>
		    			<div class="links">
		    				<div>Make a payment</div>
		    				<div>Manage your Direct Debit</div>
		    				<div>Top up</div>
		    			</div>
		    		</div>
		    		<div class="col-md-3">
		    			<div class="header">Settings</div>
		    			<div class="links">
		    				<div>Account Settings</div>
		    				<div>Your Details</div>
		    				<div>Password & Security</div>
		    			</div>
		    		</div>
		    		<div class="col-md-3">
		    			<div class="header">Take Control</div>
		    			<div class="links">
		    				<div>Download the App</div>
		    				<div>&nbsp;</div>
		    				<div>&nbsp;</div>
		    			</div>
		    		</div>
		    	</div>
		    </div>

		  </div>
		</nav>

		<div class="container">

			<div id="carousel-container">

			</div>




		<!-- 	<div class="caruosel">
				<div class="row">
					<div class="col-md-6">
						<img src="resources/devices-icon.png"/>
					</div>
					<div class="col-md-6">
						<div>
							<h3>Great Devices.</h3>
							<h3>Affordable Prices.</h3>
						</div>
						<p class="text-muted">
							Shop our large selection of devices and save big for  the whole family. Order now!
						</p>
						<div class="btn btn-success rounded-btn">SHOP NOW</div>
					</div>
				</div>

			</div> -->
			
			<div class="banners">
				<div class="row">
					<div class="col-md-4 home-banner">

						<div class="banner-icon home-banner">
							<img src="resources/logos-icon.png"/>
						</div>
						<div class="banner-desc">
							<span class="h4">
								Keep it simple
								with our new mobile app.
							</span>
						</div>
						<div class="link">
							<a class="banner-link">Download Now > </a>
						</div>
					</div>


					<div class="col-md-4 home-banner">
						<div class="border-line border-right"></div>
						<div class="border-line border-left"></div>

						<div class="banner-text">
							<span class="we-do">we do data</span>
							<span class="we-do-diff blue-color">differently</span>
						</div>
						<div class="banner-desc">
							<span class="h4">
								Unlimited streaming,
								No overages.
							</span>
						</div>
						<div class="link">
							<a class="banner-link">Free your data > </a>
						</div>
					</div>


					<div class="col-md-4 home-banner">
						<div class="banner-icon">
							<img src="resources/map-icon.png"/>
						</div>
						<div class="banner-desc">
							<span class="h4">
								Let's set the record
								Straight on coverage
							</span>
						</div>
						<div class="link">
							<a class="banner-link">See how > </a>
						</div>
					</div>
				</div>
			</div>
			








			<div class="plan-select-container">

				<h3>
					One plan. Pick a size. Simple.
				</h3>

				<div class="plans-selection">
					
					<div class="plan-item">
						<div class="plan-icon">
							<span class="plan-name">
								S
							<span>
							<div class="plan-color red"></div>
						</div>
						<div class="plan-price">
							1GB/30$
						</div>
					</div>

					<div class="plan-item">
						<div class="plan-icon">
							<span class="plan-name">
								M
							<span>
							<div class="plan-color yellow"></div>
						</div>
						<div class="plan-price">
							3GB/45$
						</div>
					</div>

					<div class="plan-item">
						<div class="plan-icon">
							<span class="plan-name">
								L
							<span>
							<div class="plan-color blue"></div>
						</div>
						<div class="plan-price">
							6GB/60$
						</div>
					</div>

					<div class="plan-item">
						<div class="plan-icon">
							<span class="plan-name">
								XL
							<span>
							<div class="plan-color orange"></div>
						</div>
						<div class="plan-price">
							12GB/80$
						</div>
					</div>

					<div class="plan-item">
						<div class="plan-icon">
							<span class="plan-name">
								XXL
							<span>
							<div class="plan-color green"></div>
						</div>
						<div class="plan-price">
							18GB/100$
						</div>
					</div>

					<!-- <div class="clear"></div> -->

				</div>
				<div class="pull-right">
					<a class="banner-link color-red">Learn more > </a>
				</div>

				<div class="comment text-muted">
					* All sizes include unlimited talk and text
				</div>

			</div>
		</div>
		<footer>

			<div class="container">
				<div class="row">
					
					<div class="col-md-3">
						<h3>SHOP</h3>
						<div class="link-list">
							<a class="color-blue">All Phones iPhone</a>
							<a class="color-blue">AndroidTM-Powered Phones</a>
							<a class="color-blue">PayLo Talk & Text Phones </a>
							<a class="color-blue">Broadband2Go </a>
							<a class="color-blue">Devices Acce</a>
						</div>
					</div>

					<div class="col-md-3">
						<h3>NO CONTRACT PLANS</h3>
						<div class="link-list">   
							<a class="color-blue">All Plans</a>
							<a class="color-blue">NewCom Mobile Unlimited Plans</a>
							<a class="color-blue">payLo Talk & Text Plans</a>
							<a class="color-blue">Broadband2Go Plans</a>
							<a class="color-blue">Internetional Offers</a>
							<a class="color-blue">NewCom Mobile Extras</a>
						</div>
					</div>

					<div class="col-md-3">
						<h3>SOME USEFUL LINK</h3>
						<div class="link-list">     
							<a class="color-blue">Find A Store</a>
							<a class="color-blue">Contact Us</a>
							<a class="color-blue">Coverage Map</a>
							<a class="color-blue">Sitemap</a>
							<a class="color-blue">Support</a>
							<a class="color-blue">About us</a>
							<a class="color-blue">Careers</a>
							<a class="color-blue">News</a>
						</div>
					</div>

					<div class="col-md-3">
						<h3>CONNECT WITH US</h3>
						<div class="social">
							<div class="social-btn">
								<i class="fa fa-facebook"></i>
							</div>
							<div class="social-btn">
								<i class="fa fa-twitter"></i>
							</div>
							<div class="social-btn">
								<i class="fa fa-youtube"></i>
							</div>
							<div class="social-btn">
								<i class="fa fa-instagram"></i>
							</div>
						</div>
					</div>

				</div>
			</div>

		</footer>





		<script src="mods.js" type="text/javascript"></script>
		<script src="app.js"></script>
		<script>
			UserSession.logInUser([]);
			var myData = {subscriberId:window.localStorage.getItem('subId')};
			var fields = UserSession.getUserInfo().sessionFields;
			
			for(var i = 0; i<fields.length; i++){
				if(fields[i].name === "msisdn"){
					myData.msisdn = fields[i].value;
				}
			}

			$.ajax({
				  url: API.endPoints.offers.url,
				  type: "get", //send it through get method
				  data:myData,
				  success: function(response,status,xhr) {
				    //Do Something
				    var obj = JSON.parse(response);
				    var fieldsObj = {
				    	text:[],
				    	checkbox:[],
				    	email:[],
				    	password:[]
				    };
				    
				    //if error do nothing.
				    if(obj.status.success === "false"){
				    	return;
				    }

				    var showFieldsDialog = false;

					for (var i in obj.offers){

						if(obj.offers[i].imageId){
							var str = obj.offers[i].imageId;
							obj.offers[i].imageId = str.replace('jpg','png');
						}

						if(obj.offers[i].requiredFields){
							
							if(obj.offers[i].requiredFields.length){
								showFieldsDialog = true;
							}

							for( var fld = 0; fld<obj.offers[i].requiredFields.length; fld++){
								var zisField = obj.offers[i].requiredFields[fld];
								if(zisField.type === "text"){
									fieldsObj.text.push(obj.offers[i].requiredFields[fld]);
								}
								if(zisField.type === "boolean"){
									fieldsObj.checkbox.push(obj.offers[i].requiredFields[fld]);
								}
								if(zisField.type === "password"){
									fieldsObj.password.push(obj.offers[i].requiredFields[fld]);
								}
								if(zisField.type === "email"){
									fieldsObj.email.push(obj.offers[i].requiredFields[fld]);
								}
							}
						}

					}

					if(showFieldsDialog){
						$('body').addClass('show-email-dialog');
							
						var source = $("#user-fields-modal").html();
						var fieldsTmpl = Handlebars.compile(source);
						var context = {"fields":fieldsObj};
						var html = fieldsTmpl(context);
						$('body').append(html);
					}
					
					var source = $("#offers_template").html();
					var template = Handlebars.compile(source);
					var context = obj;
					var html = template(context);
					$('body #carousel-container').append(html);
					$($('.carousel-indicators li')[0]).addClass('active');
					$($('.carousel-inner .item')[0]).addClass('active');

				  },

				  error: function(xhr) {
				    //Do Something to handle error
				  }
				});

		</script>




	</body>

</html>